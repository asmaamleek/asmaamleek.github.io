<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Ù„Ø¹Ø¨Ø© Ù‡Ø°Ø§ ÙˆÙ‡Ø°Ù‡ ğŸŒŸ - Ù…ÙŠØ³ Ø£Ø³Ù…Ø§Ø¡</title>
<link href="https://fonts.googleapis.com/css2?family=Tajawal:wght@400;700;900&display=swap" rel="stylesheet">
<style>
  :root {
    --boy: #4FC3F7;
    --boy-dark: #0288D1;
    --girl: #F48FB1;
    --girl-dark: #C2185B;
    --gold: #FFD700;
    --green: #66BB6A;
    --green-dark: #2E7D32;
    --red: #EF5350;
    --red-dark: #B71C1C;
    --bg: #FFF9C4;
    --text: #333333;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Tajawal', sans-serif;
    background: var(--bg);
    min-height: 100vh;
    overflow-x: hidden;
    color: var(--text);
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  /* Animated Background */
  body::before {
    content: '';
    position: fixed;
    inset: 0;
    background: 
      radial-gradient(circle at 20% 20%, rgba(255,215,0,0.2) 0%, transparent 40%),
      radial-gradient(circle at 80% 80%, rgba(244,143,177,0.2) 0%, transparent 40%),
      radial-gradient(circle at 50% 50%, rgba(79,195,247,0.15) 0%, transparent 60%);
    pointer-events: none;
    z-index: 0;
  }

  .container {
    width: 100%;
    max-width: 700px;
    padding: 20px;
    position: relative;
    z-index: 1;
    display: flex;
    flex-direction: column;
    min-height: 100vh;
  }

  /* Screens */
  .screen {
    display: none;
    animation: bounceIn 0.8s cubic-bezier(0.68, -0.55, 0.265, 1.55);
    flex-direction: column;
    align-items: center;
    justify-content: center;
    flex-grow: 1;
  }
  .screen.active { display: flex; }

  /* HEADER */
  .header { text-align: center; padding: 20px 0; }
  .header h1 {
    font-size: clamp(2.2rem, 6vw, 3.5rem);
    font-weight: 900;
    background: linear-gradient(135deg, #FF6B6B, #FF8E53, #FFD700, #4CAF50, #2196F3, #9C27B0);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
    filter: drop-shadow(2px 2px 2px rgba(0,0,0,0.1));
    margin-bottom: 10px;
  }
  .subtitle {
    font-size: 1.2rem;
    color: #6A1B9A;
    font-weight: 700;
    background: white;
    padding: 5px 15px;
    border-radius: 20px;
    display: inline-block;
    box-shadow: 0 4px 6px rgba(0,0,0,0.05);
  }

  /* RULES BOX */
  .rules {
    display: flex;
    gap: 15px;
    justify-content: center;
    margin: 15px 0;
    width: 100%;
  }
  .rule-card {
    flex: 1;
    padding: 10px;
    border-radius: 20px;
    font-size: 1.3rem;
    font-weight: 900;
    text-align: center;
    box-shadow: 0 4px 10px rgba(0,0,0,0.1);
    background: white;
    border: 3px solid transparent;
  }
  .rule-hatha { border-color: var(--boy); color: var(--boy-dark); }
  .rule-hathihi { border-color: var(--girl); color: var(--girl-dark); }

  /* PROGRESS */
  .progress-container { width: 100%; margin-bottom: 20px; }
  .score-display {
    display: flex;
    justify-content: space-between;
    font-size: 1.2rem;
    font-weight: 900;
    color: #6A1B9A;
    margin-bottom: 8px;
  }
  .progress-bar {
    background: rgba(255,255,255,0.7);
    border-radius: 50px;
    height: 18px;
    box-shadow: inset 0 3px 6px rgba(0,0,0,0.1);
    overflow: hidden;
    border: 2px solid white;
  }
  .progress-fill {
    height: 100%;
    background: linear-gradient(90deg, #4CAF50, #8BC34A);
    border-radius: 50px;
    transition: width 0.5s cubic-bezier(0.4, 0, 0.2, 1);
  }

  /* QUESTION CARD */
  .question-card {
    background: white;
    border-radius: 30px;
    padding: 30px 20px;
    width: 100%;
    box-shadow: 0 15px 35px rgba(0,0,0,0.1);
    text-align: center;
    position: relative;
    border: 4px solid transparent;
    background-clip: padding-box;
  }
  .question-card::before {
    content: '';
    position: absolute;
    inset: -4px;
    border-radius: 34px;
    background: linear-gradient(135deg, var(--boy), var(--girl), var(--gold));
    z-index: -1;
  }

  .q-text {
    font-size: clamp(1.8rem, 5vw, 2.5rem);
    font-weight: 900;
    color: #212121;
    margin-bottom: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 10px;
  }
  .speaker-icon {
    cursor: pointer;
    font-size: 1.5rem;
    background: #f0f0f0;
    border-radius: 50%;
    width: 45px;
    height: 45px;
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s;
    box-shadow: 0 3px 5px rgba(0,0,0,0.1);
  }
  .speaker-icon:hover { transform: scale(1.1); background: #e0e0e0; }
  .speaker-icon:active { transform: scale(0.95); }

  .emoji-display {
    font-size: clamp(5rem, 15vw, 8rem);
    margin: 10px 0;
    display: inline-block;
    animation: floatAnim 3s ease-in-out infinite;
    filter: drop-shadow(0 10px 10px rgba(0,0,0,0.15));
  }

  /* OPTIONS (3D Buttons) */
  .options {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 20px;
    margin-top: 25px;
  }
  .option-btn {
    padding: 20px 10px;
    border: none;
    border-radius: 20px;
    font-family: 'Tajawal', sans-serif;
    font-size: clamp(1.8rem, 5vw, 2.5rem);
    font-weight: 900;
    cursor: pointer;
    transition: all 0.1s;
    color: white;
    position: relative;
    top: 0;
  }
  
  .option-hatha {
    background: var(--boy);
    box-shadow: 0 8px 0 var(--boy-dark), 0 15px 20px rgba(0,0,0,0.2);
  }
  .option-hathihi {
    background: var(--girl);
    box-shadow: 0 8px 0 var(--girl-dark), 0 15px 20px rgba(0,0,0,0.2);
  }

  .option-btn:hover { filter: brightness(1.1); }
  .option-btn:active {
    top: 8px;
    box-shadow: 0 0px 0 transparent, 0 5px 10px rgba(0,0,0,0.2) !important;
  }

  .option-btn.correct {
    background: var(--green) !important;
    box-shadow: 0 8px 0 var(--green-dark), 0 15px 20px rgba(0,0,0,0.2) !important;
    animation: pulseCorrect 0.5s ease;
  }
  .option-btn.wrong {
    background: var(--red) !important;
    box-shadow: 0 8px 0 var(--red-dark), 0 15px 20px rgba(0,0,0,0.2) !important;
    animation: shake 0.4s ease;
  }
  .option-btn:disabled { cursor: not-allowed; pointer-events: none; }

  /* FEEDBACK */
  .feedback {
    font-size: 1.8rem;
    font-weight: 900;
    text-align: center;
    margin-top: 25px;
    min-height: 45px;
    opacity: 0;
    transition: opacity 0.3s;
  }
  .feedback.show { opacity: 1; animation: popIn 0.4s cubic-bezier(0.175, 0.885, 0.32, 1.275); }
  .feedback.correct { color: var(--green-dark); }
  .feedback.wrong { color: var(--red-dark); }

  /* START & END SCREENS */
  .start-card, .end-card {
    background: white;
    border-radius: 30px;
    padding: 40px 20px;
    box-shadow: 0 20px 50px rgba(0,0,0,0.15);
    text-align: center;
    width: 100%;
    position: relative;
    overflow: hidden;
  }
  
  .big-emoji {
    font-size: 6rem;
    margin-bottom: 10px;
    display: inline-block;
    animation: bounce 2s infinite;
  }

  .primary-btn {
    background: linear-gradient(135deg, #FF6B6B, #FF8E53);
    color: white;
    border: none;
    padding: 15px 40px;
    border-radius: 50px;
    font-family: 'Tajawal', sans-serif;
    font-size: 1.6rem;
    font-weight: 900;
    cursor: pointer;
    margin-top: 25px;
    box-shadow: 0 8px 0 #D84315, 0 15px 20px rgba(255,107,107,0.4);
    transition: all 0.1s;
    position: relative;
    top: 0;
  }
  .primary-btn:active {
    top: 8px;
    box-shadow: 0 0px 0 transparent, 0 5px 10px rgba(255,107,107,0.4);
  }

  .miss-msg {
    font-size: 1.4rem;
    font-weight: 800;
    color: #6A1B9A;
    background: #F3E5F5;
    padding: 20px;
    border-radius: 20px;
    margin: 20px 0;
    border: 3px dashed #AB47BC;
    line-height: 1.6;
  }

  /* Confetti Container */
  #confetti-container {
    position: fixed;
    top: 0; left: 0; width: 100%; height: 100%;
    pointer-events: none;
    z-index: 999;
  }
  .confetti {
    position: absolute;
    width: 12px; height: 12px;
    border-radius: 2px;
    animation: fall linear forwards;
  }

  /* Floating elements */
  .floaty {
    position: fixed; font-size: 2rem;
    animation: floatRandom 6s ease-in-out infinite;
    pointer-events: none; opacity: 0.6; z-index: 0;
  }

  /* ANIMATIONS */
  @keyframes bounceIn {
    0% { transform: scale(0.5); opacity: 0; }
    100% { transform: scale(1); opacity: 1; }
  }
  @keyframes popIn {
    0% { transform: scale(0.5); }
    80% { transform: scale(1.1); }
    100% { transform: scale(1); }
  }
  @keyframes floatAnim {
    0%, 100% { transform: translateY(0) rotate(-3deg); }
    50% { transform: translateY(-20px) rotate(3deg); }
  }
  @keyframes pulseCorrect {
    0% { transform: scale(1); }
    50% { transform: scale(1.1); }
    100% { transform: scale(1); }
  }
  @keyframes shake {
    0%, 100% { transform: translateX(0); }
    20%, 60% { transform: translateX(-8px); }
    40%, 80% { transform: translateX(8px); }
  }
  @keyframes bounce {
    0%, 100% { transform: translateY(0); }
    50% { transform: translateY(-15px); }
  }
  @keyframes fall {
    0% { transform: translateY(-20px) rotate(0deg); opacity: 1; }
    100% { transform: translateY(100vh) rotate(720deg); opacity: 0; }
  }
  @keyframes floatRandom {
    0%, 100% { transform: translateY(0) rotate(0deg); }
    33% { transform: translateY(-30px) rotate(15deg); }
    66% { transform: translateY(15px) rotate(-10deg); }
  }
</style>
</head>
<body>

<!-- Decorations -->
<div class="floaty" style="top:10%;left:5%;animation-delay:0s">â­</div>
<div class="floaty" style="top:20%;right:5%;animation-delay:1s">ğŸŒ¸</div>
<div class="floaty" style="top:70%;left:8%;animation-delay:2s">ğŸˆ</div>
<div class="floaty" style="top:80%;right:8%;animation-delay:0.5s">ğŸ¦‹</div>

<div class="container">
  
  <div class="header">
    <h1>ğŸŒŸ Ù‡Ø°Ø§ ÙˆÙ‡Ø°Ù‡ ğŸŒŸ</h1>
    <div class="subtitle">ğŸ‘¦ Ù…Ø°ÙƒØ± (Ù‡Ø°Ø§) &nbsp;|&nbsp; ğŸ‘§ Ù…Ø¤Ù†Ø« (Ù‡Ø°Ù‡)</div>
  </div>

  <!-- START SCREEN -->
  <div class="screen active" id="startScreen">
    <div class="start-card">
      <span class="big-emoji">ğŸ‘©â€ğŸ«</span>
      <h2 style="font-size: 2.5rem; color: #6A1B9A; margin-bottom: 15px;">Ø£Ù‡Ù„Ø§Ù‹ Ø¨Ùƒ ÙŠØ§ Ø¨Ø·Ù„!</h2>
      <p style="font-size: 1.3rem; margin-bottom: 25px; color: #555; font-weight: 700;">
        Ù…ÙŠØ³ Ø£Ø³Ù…Ø§Ø¡ Ø£Ø¹Ø¯Øª Ù„Ùƒ ØªØ­Ø¯ÙŠØ§Ù‹ Ù…Ù…ØªØ¹Ø§Ù‹!<br>
        Ù‡Ù„ Ø£Ù†Øª Ù…Ø³ØªØ¹Ø¯ Ù„Ù…Ø¹Ø±ÙØ© Ø§Ù„ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©ØŸ
      </p>
      <button class="primary-btn" onclick="startGame()">â–¶ï¸ Ø§Ø¨Ø¯Ø£ Ø§Ù„Ù„Ø¹Ø¨</button>
    </div>
  </div>

  <!-- GAME SCREEN -->
  <div class="screen" id="gameScreen">
    <div class="rules">
      <div class="rule-card rule-hatha">ğŸ’™ Ù‡Ø°Ø§ Ù„Ù„ÙˆÙ„Ø¯</div>
      <div class="rule-card rule-hathihi">ğŸ’— Ù‡Ø°Ù‡ Ù„Ù„Ø¨Ù†Øª</div>
    </div>

    <div class="progress-container">
      <div class="score-display">
        <span id="qCounter">Ø§Ù„Ø³Ø¤Ø§Ù„ 1 / 20</span>
        <span>Ø§Ù„Ù†Ù‚Ø§Ø·: â­ <span id="scoreText">0</span></span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="progressFill" style="width:0%"></div>
      </div>
    </div>

    <div class="question-card" id="questionCard">
      <div class="q-text">
        <span id="qWordText">...</span>
        <div class="speaker-icon" onclick="speakCurrentWord()" title="Ø§Ø³ØªÙ…Ø¹ Ù„Ù„ÙƒÙ„Ù…Ø©">ğŸ”Š</div>
      </div>
      <span class="emoji-display" id="qEmoji">â“</span>
      
      <div class="options">
        <button class="option-btn option-hatha" id="btn1" onclick="answer(0)">Ù‡Ø°Ø§</button>
        <button class="option-btn option-hathihi" id="btn2" onclick="answer(1)">Ù‡Ø°Ù‡</button>
      </div>
      
      <div class="feedback" id="feedback"></div>
    </div>
  </div>

  <!-- END SCREEN -->
  <div class="screen" id="endScreen">
    <div class="end-card">
      <span class="big-emoji" id="endEmoji">ğŸ‘©â€ğŸ«</span>
      <h2 style="font-size: 3rem; color: #FF6B6B; margin-bottom: 10px;" id="endTitle">Ø§Ù„Ù†Ù‡Ø§ÙŠØ©!</h2>
      <div style="font-size: 2.5rem; letter-spacing: 5px; margin: 10px 0;" id="starRow">â­â­â­â­â­</div>
      <div class="miss-msg" id="missMsg"></div>
      <button class="primary-btn" onclick="resetGame()">ğŸ”„ Ø§Ù„Ø¹Ø¨ Ù…Ù† Ø¬Ø¯ÙŠØ¯</button>
    </div>
  </div>

</div>

<div id="confetti-container"></div>

<script>
// Original Questions Data
const allQuestions = [
  { emoji: "ğŸš—", word: "Ø³ÙŠØ§Ø±Ø©", answer: 1 },
  { emoji: "ğŸ“š", word: "ÙƒØªØ§Ø¨", answer: 0 },
  { emoji: "ğŸŒ¸", word: "ÙˆØ±Ø¯Ø©", answer: 1 },
  { emoji: "ğŸ¦", word: "Ø£Ø³Ø¯", answer: 0 },
  { emoji: "ğŸ’", word: "Ø­Ù‚ÙŠØ¨Ø©", answer: 1 },
  { emoji: "ğŸ ", word: "Ø¨ÙŠØª", answer: 0 },
  { emoji: "ğŸ±", word: "Ù‚Ø·Ø©", answer: 1 },
  { emoji: "ğŸ–Šï¸", word: "Ù‚Ù„Ù…", answer: 0 },
  { emoji: "ğŸ", word: "ØªÙØ§Ø­Ø©", answer: 1 },
  { emoji: "ğŸ˜", word: "ÙÙŠÙ„", answer: 0 },
  { emoji: "ğŸŒ™", word: "Ù‚Ù…Ø±", answer: 0 },
  { emoji: "ğŸ¦¢", word: "Ø¨Ø·Ø©", answer: 1 },
  { emoji: "âš½", word: "ÙƒØ±Ø©", answer: 1 },
  { emoji: "ğŸª‘", word: "ÙƒØ±Ø³ÙŠ", answer: 0 },
  { emoji: "ğŸ", word: "Ù†Ø­Ù„Ø©", answer: 1 },
  { emoji: "ğŸŒ", word: "Ø´Ù…Ø³", answer: 1 },
  { emoji: "ğŸŸ", word: "Ø³Ù…ÙƒØ©", answer: 1 },
  { emoji: "ğŸ¦…", word: "Ù†Ø³Ø±", answer: 0 },
  { emoji: "ğŸŒ·", word: "Ø²Ù‡Ø±Ø©", answer: 1 },
  { emoji: "ğŸŠ", word: "ØªÙ…Ø³Ø§Ø­", answer: 0 },
];

let questions = [];
let current = 0;
let score = 0;
let answered = false;

// Audio Context for simple sound effects (No external files needed)
const AudioContext = window.AudioContext || window.webkitAudioContext;
let audioCtx;

function initAudio() {
  if (!audioCtx) {
    audioCtx = new AudioContext();
  }
  if (audioCtx.state === 'suspended') {
    audioCtx.resume();
  }
}

function playTone(freq, type, duration) {
  if (!audioCtx) return;
  const oscillator = audioCtx.createOscillator();
  const gainNode = audioCtx.createGain();
  oscillator.type = type;
  oscillator.frequency.value = freq;
  oscillator.connect(gainNode);
  gainNode.connect(audioCtx.destination);
  oscillator.start();
  gainNode.gain.setValueAtTime(0.1, audioCtx.currentTime);
  gainNode.gain.exponentialRampToValueAtTime(0.0001, audioCtx.currentTime + duration);
  oscillator.stop(audioCtx.currentTime + duration);
}

function playCorrectSound() {
  playTone(523.25, 'sine', 0.1); // C5
  setTimeout(() => playTone(659.25, 'sine', 0.15), 100); // E5
  setTimeout(() => playTone(783.99, 'sine', 0.2), 200); // G5
}

function playWrongSound() {
  playTone(300, 'sawtooth', 0.2);
  setTimeout(() => playTone(250, 'sawtooth', 0.3), 150);
}

// Text to Speech
function speakCurrentWord() {
  const word = questions[current].word;
  const utterance = new SpeechSynthesisUtterance(word);
  utterance.lang = 'ar-SA'; // Arabic
  utterance.rate = 0.85; // slightly slower for kids
  utterance.pitch = 1.2; // slightly higher pitch
  window.speechSynthesis.cancel(); // Stop any currently playing audio
  window.speechSynthesis.speak(utterance);
}

// Shuffle array function
function shuffle(array) {
  let currentIndex = array.length, randomIndex;
  while (currentIndex !== 0) {
    randomIndex = Math.floor(Math.random() * currentIndex);
    currentIndex--;
    [array[currentIndex], array[randomIndex]] = [array[randomIndex], array[currentIndex]];
  }
  return array;
}

function switchScreen(screenId) {
  document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
  document.getElementById(screenId).classList.add('active');
}

function startGame() {
  initAudio(); // Initialize audio context on user interaction
  resetGame();
}

function loadQuestion() {
  const q = questions[current];
  document.getElementById('qCounter').textContent = `Ø§Ù„Ø³Ø¤Ø§Ù„ ${current + 1} / ${questions.length}`;
  
  document.getElementById('qWordText').textContent = q.word;
  document.getElementById('qEmoji').textContent = q.emoji;
  
  const fb = document.getElementById('feedback');
  fb.className = 'feedback';
  fb.textContent = '';
  
  const btn1 = document.getElementById('btn1');
  const btn2 = document.getElementById('btn2');
  btn1.className = 'option-btn option-hatha';
  btn2.className = 'option-btn option-hathihi';
  btn1.disabled = false;
  btn2.disabled = false;

  answered = false;
  document.getElementById('progressFill').style.width = `${(current / questions.length) * 100}%`;
  
  // Auto speak word when question loads (optional, adds fun!)
  setTimeout(speakCurrentWord, 300);
}

function answer(choice) {
  if (answered) return;
  answered = true;

  const q = questions[current];
  const correct = choice === q.answer;
  const btn = document.getElementById(choice === 0 ? 'btn1' : 'btn2');
  const fb = document.getElementById('feedback');

  document.getElementById('btn1').disabled = true;
  document.getElementById('btn2').disabled = true;

  if (correct) {
    score++;
    playCorrectSound();
    btn.classList.add('correct');
    fb.textContent = getPositiveMsg();
    fb.className = 'feedback show correct';
    createSmallConfetti(btn); // mini confetti on correct button
  } else {
    playWrongSound();
    btn.classList.add('wrong');
    // Highlight correct answer
    const correctBtn = document.getElementById(q.answer === 0 ? 'btn1' : 'btn2');
    correctBtn.classList.add('correct');
    fb.textContent = 'âŒ Ø­Ø§ÙˆÙ„ Ù…Ø±Ø© Ø£Ø®Ø±Ù‰!';
    fb.className = 'feedback show wrong';
  }

  document.getElementById('scoreText').textContent = score;

  setTimeout(() => {
    current++;
    if (current >= questions.length) {
      showEnd();
    } else {
      loadQuestion();
    }
  }, 1800);
}

function getPositiveMsg() {
  const msgs = ['âœ… Ø¨Ø·Ù„! ğŸŒŸ', 'âœ… Ù…Ù…ØªØ§Ø²! ğŸ‰', 'âœ… Ø±Ø§Ø¦Ø¹ Ø¬Ø¯Ø§Ù‹! â­', 'âœ… Ø°ÙƒÙŠ! ğŸ†', 'âœ… Ø£Ø­Ø³Ù†Øª! ğŸŒˆ'];
  return msgs[Math.floor(Math.random() * msgs.length)];
}

function showEnd() {
  document.getElementById('progressFill').style.width = '100%';
  switchScreen('endScreen');

  const pct = score / questions.length;
  let stars = 'â­â­â­â­â­';
  let msg = '';
  let emoji = 'ğŸ‘©â€ğŸ«';
  let title = 'ğŸ‰ Ø£Ø­Ø³Ù†Øª ÙŠØ§ Ø¨Ø·Ù„! ğŸ‰';

  if (pct === 1) {
    stars = 'â­â­â­â­â­';
    msg = `ğŸŒ¹ Ù…ÙŠØ³ Ø£Ø³Ù…Ø§Ø¡ ÙØ®ÙˆØ±Ø© Ø¨Ùƒ Ø¬Ø¯Ø§Ù‹ Ø¬Ø¯Ø§Ù‹! ğŸŒ¹<br>Ø£Ù†Øª Ù†Ø¬Ù… Ø±ÙŠØ§Ø¶ Ø§Ù„Ø£Ø·ÙØ§Ù„!<br>Ø­ØµÙ„Øª Ø¹Ù„Ù‰ Ø§Ù„Ø¹Ù„Ø§Ù…Ø© Ø§Ù„ÙƒØ§Ù…Ù„Ø© ${score}/${questions.length} ğŸ†`;
    emoji = 'ğŸ¥°';
    addConfetti(60);
    setTimeout(playCorrectSound, 100);
    setTimeout(playCorrectSound, 300);
  } else if (pct >= 0.8) {
    stars = 'â­â­â­â­';
    msg = `ğŸ’– Ù…ÙŠØ³ Ø£Ø³Ù…Ø§Ø¡ ÙØ®ÙˆØ±Ø© Ø¨Ùƒ! ğŸ’–<br>Ø£Ø¯Ø§Ø¡ Ø±Ø§Ø¦Ø¹ØŒ Ø§Ø³ØªÙ…Ø± ÙÙŠ Ø§Ù„ØªØ¹Ù„Ù… ÙŠØ§ Ù†Ø¬Ù…! ğŸŒŸ<br>Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}/${questions.length}`;
    emoji = 'ğŸ˜Š';
    addConfetti(30);
    playCorrectSound();
  } else if (pct >= 0.6) {
    stars = 'â­â­â­';
    msg = `ğŸ’› Ø£Ø­Ø³Ù†Øª ÙŠØ§ ØµØºÙŠØ±ÙŠ! ğŸ’›<br>Ø±Ø§Ø¬Ø¹ Ø§Ù„Ø¯Ø±Ø³ Ù„ØªØµØ¨Ø­ Ø£ÙØ¶Ù„ ÙˆØ£ÙØ¶Ù„! ğŸ“š<br>Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}/${questions.length}`;
    emoji = 'ğŸ˜„';
    title = 'Ù…Ø­Ø§ÙˆÙ„Ø© Ø¬ÙŠØ¯Ø©! ğŸ‘';
  } else {
    stars = 'â­â­';
    msg = `ğŸ’™ Ù„Ø§ Ø¨Ø£Ø³ ÙŠØ§ Ø­Ø¨ÙŠØ¨ÙŠ! ğŸ’™<br>Ù…ÙŠØ³ Ø£Ø³Ù…Ø§Ø¡ ØªØ´Ø¬Ø¹Ùƒ Ù„Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ù…Ø±Ø© Ø£Ø®Ø±Ù‰! ğŸ’ª<br>Ø§Ù„Ù†Ù‚Ø§Ø·: ${score}/${questions.length}`;
    emoji = 'ğŸ¤—';
    title = 'Ù†Ø­ØªØ§Ø¬ Ù„ØªØ¯Ø±ÙŠØ¨ Ø£ÙƒØ«Ø±! ğŸ“š';
  }

  document.getElementById('starRow').textContent = stars;
  document.getElementById('endTitle').textContent = title;
  document.getElementById('endEmoji').textContent = emoji;
  document.getElementById('missMsg').innerHTML = msg;
}

function addConfetti(amount) {
  const container = document.getElementById('confetti-container');
  container.innerHTML = ''; // clear old confetti
  const colors = ['#FF6B6B','#FFD700','#4CAF50','#2196F3','#9C27B0','#FF8E53', '#00BCD4'];
  
  for (let i = 0; i < amount; i++) {
    const c = document.createElement('div');
    c.className = 'confetti';
    c.style.background = colors[Math.floor(Math.random() * colors.length)];
    c.style.left = Math.random() * 100 + 'vw';
    c.style.animationDuration = (2 + Math.random() * 3) + 's';
    c.style.animationDelay = Math.random() * 2 + 's';
    
    // random shapes
    if (Math.random() > 0.5) c.style.borderRadius = '50%';
    
    container.appendChild(c);
  }
}

function createSmallConfetti(element) {
  const container = document.getElementById('confetti-container');
  const rect = element.getBoundingClientRect();
  const colors = ['#FFD700', '#4CAF50', '#FFF'];
  
  for(let i=0; i<10; i++) {
    const c = document.createElement('div');
    c.className = 'confetti';
    c.style.background = colors[Math.floor(Math.random() * colors.length)];
    c.style.left = (rect.left + rect.width/2 + (Math.random()*40 - 20)) + 'px';
    c.style.top = (rect.top + (Math.random()*20 - 10)) + 'px';
    c.style.animationDuration = '1s';
    c.style.width = '8px'; c.style.height = '8px';
    container.appendChild(c);
    
    // cleanup
    setTimeout(() => c.remove(), 1000);
  }
}

function resetGame() {
  current = 0;
  score = 0;
  answered = false;
  
  // Clone and shuffle questions
  questions = shuffle([...allQuestions]);
  
  document.getElementById('scoreText').textContent = '0';
  document.getElementById('confetti-container').innerHTML = ''; // Clear confetti
  
  switchScreen('gameScreen');
  loadQuestion();
}
</script>
</body>
</html>
